twistlock:
  # -- Toggle deployment of Twistlock.
  enabled: true
  git:
    repo: "https://gitlab.com/enbuild-staging/charts/twistlock.git"
    path: "./chart"
    tag: "0.11.4-bb.1"
  # -- Flux reconciliation overrides specifically for the Twistlock Package
  flux: {}
  # -- Redirect the package ingress to a specific Istio Gateway (listed in `istio.gateways`).  The default is "public".
  ingress:
    gateway: ""
  sso:
    # -- Toggle SAML SSO, requires a license and enabling the init job - see https://gitlab.com/enbuild-staging/charts/twistlock/-/blob/main/docs/initialization.md
    enabled: false
    # -- SAML client ID
    client_id: ""
    # -- SAML Povider Alias (optional)
    provider_name: ""
    # -- SAML Identity Provider. `shibboleth` is recommended by Twistlock support for Keycloak
    provider_type: "shibboleth"
    # -- Identity Provider url with path to realm
    issuer_uri: "https://{{ .Values.sso.oidc.host }}/auth/realms/{{ .Values.sso.oidc.realm }}"
    # -- SAML Identity Provider SSO URL
    idp_url: "https://{{ .Values.sso.oidc.host }}/auth/realms/{{ .Values.sso.oidc.realm }}/protocol/saml"
    # -- Console URL of the Twistlock app (optional)
    console_url: "https://twistlock.{{ .Values.domain }}"
    # -- Groups attribute (optional)
    groups: ""
    # -- X.509 Certificate from Identity Provider (i.e. Keycloak). See https://gitlab.com/enbuild-staging/charts/twistlock/-/blob/main/docs/KEYCLOAK.md for format. Use the `|-` syntax for multiline string.
    cert: ""
  # -- Values to passthrough to the twistlock chart: https://gitlab.com/enbuild-staging/charts/twistlock.git
  values:
    console:
      image:
        repository: registry.gitlab.com/enbuild-staging/container_registry/twistlock-console/console
      trustedImages:
        registryMatches:
          - registry.gitlab.com/enbuild-staging/container_registry/*
    defender:
      image:
        repository: registry.gitlab.com/enbuild-staging/container_registry/twistlock-defender/defender
    init:
      image:
        repository: registry.gitlab.com/enbuild-staging/container_registry/big-bang-base
    bbtests:
      scripts:
        image: registry.gitlab.com/enbuild-staging/container_registry/stedolan-jq:1.6
  # -- Post Renderers.  See docs/postrenders.md
  postRenderers: []
